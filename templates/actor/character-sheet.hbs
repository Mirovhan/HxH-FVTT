
<form class="{{cssClass}} sheet-body hxh" autocomplete="off">
  <div class="grid-2">
    <div>
      <div class="panel">
        <div class="title">Estad√≠sticas</div>
        <table>
          <thead><tr><th>VAL</th><th>BON</th><th>Origen</th><th>Atributo</th><th>Progresi√≥n</th><th>üé≤</th></tr></thead>
          <tbody>
            {{#each system.stats as |s k|}}
            <tr>
              <td><input class="tiny" name="system.stats.{{k}}.valor" type="number" value="{{s.valor}}"></td>
              <td><input class="tiny" name="system.stats.{{k}}.bono"  type="number" value="{{s.bono}}"></td>
              <td><input class="tiny" name="system.stats.{{k}}.origen"type="number" value="{{s.origen}}"></td>
              <td style="text-align:left;">{{k}}</td>
              <td>
                <div class="pips">
                  {{#times s.origen}}<div class="pip on"></div>{{/times}}
                  {{#times (subtract 20 s.origen)}}<div class="pip"></div>{{/times}}
                </div>
              </td>
              <td class="rollcell"><button type="button" class="btn" data-action="roll-stat" data-key="{{k}}">üé≤</button></td>
            </tr>
            {{/each}}
          </tbody>
        </table>
        <div class="row">
          <label>Expericia:</label><input class="tiny" name="system.experticia" type="number" value="{{system.experticia}}">
          <label>Nivel:</label><input class="tiny" name="system.progreso.nivel" type="number" value="{{system.progreso.nivel}}">
          <label>Iniciativa:</label><input class="tiny" name="system.iniciativa" type="number" value="{{system.iniciativa}}">
        </div>
      </div>

      <div class="panel">
        <div class="title">Vida &amp; Energ√≠a</div>
        <div class="grid-2">
          <div>
            <label>Vida</label>
            <div class="row">
              <input name="system.vida.actual" type="number" value="{{system.vida.actual}}"><span>/</span>
              <input name="system.vida.total"  type="number" value="{{system.vida.total}}">
            </div>
          </div>
          <div>
            <label>Energ√≠a</label>
            <div class="row">
              <input name="system.energia.actual" type="number" value="{{system.energia.actual}}"><span>/</span>
              <input name="system.energia.total"  type="number" value="{{system.energia.total}}">
            </div>
          </div>
        </div>
      </div>

      <div class="panel">
        <div class="title">Armas</div>
        {{#each system.armas as |a i|}}
          <div class="grid-4" style="margin-bottom:.35rem;">
            <input name="system.armas.{{i}}.nombre" value="{{a.nombre}}" placeholder="Nombre">
            <input name="system.armas.{{i}}.dado"   value="{{a.dado}}"   placeholder="1d6">
            <select name="system.armas.{{i}}.stat.key">
              {{#each ../system.stats as |s k|}}<option value="{{k}}" {{#if (eq ../a.stat.key k)}}selected{{/if}}>{{k}}</option>{{/each}}
            </select>
            <input name="system.armas.{{i}}.precision" type="number" value="{{a.precision}}" placeholder="Precisi√≥n">
            <input style="grid-column: span 3;" name="system.armas.{{i}}.efectos" value="{{a.efectos}}" placeholder="Efectos">
            <div class="rollcell">
              <button type="button" class="btn" data-action="roll-ataque" data-index="{{i}}">‚öîÔ∏è</button>
              <button type="button" class="btn" data-action="del-arma" data-index="{{i}}">‚úñ</button>
            </div>
          </div>
        {{/each}}
        <button type="button" class="btn" data-action="add-arma">+ Arma</button>
      </div>
    </div>

    <div>
      <div class="panel">
        <div class="title">Evasi√≥n Total</div>
        <div class="grid-3">
          <div><label>Base</label><input class="tiny" name="system.evasiones.base" type="number" value="{{system.evasiones.base}}"></div>
          <div><label>Reflejos</label><div>{{system.salvaciones.reflejos.total}}</div></div>
          <div><label>Total</label><div>{{system.evasiones.total}}</div></div>
        </div>
        <div style="margin-top:6px;">
          <table>
            <thead><tr><th>Nombre</th><th>V</th><th>SD</th><th>D</th><th>Valor</th><th></th></tr></thead>
            <tbody>
              {{#each system.evasiones.armaduras as |r i|}}
              <tr>
                <td><input name="system.evasiones.armaduras.{{i}}.nombre" value="{{r.nombre}}"></td>
                <td><input class="tiny" name="system.evasiones.armaduras.{{i}}.v" type="number" value="{{r.v}}"></td>
                <td><input class="tiny" name="system.evasiones.armaduras.{{i}}.sd" type="number" value="{{r.sd}}"></td>
                <td><input class="tiny" name="system.evasiones.armaduras.{{i}}.d" type="number" value="{{r.d}}"></td>
                <td><input class="tiny" name="system.evasiones.armaduras.{{i}}.valor" type="number" value="{{r.valor}}"></td>
                <td class="rollcell"><button type="button" class="btn" data-action="del-armadura" data-index="{{i}}">‚úñ</button></td>
              </tr>
              {{/each}}
            </tbody>
          </table>
          <button type="button" class="btn" data-action="add-armadura">+ Armadura</button>
        </div>
      </div>

      <div class="panel">
        <div class="title">Salvaciones</div>
        <table>
          <thead><tr><th>Tipo</th><th>Bono especial</th><th>Total</th><th>üé≤</th></tr></thead>
          <tbody>
            <tr><td style="text-align:left;">Fortaleza</td>
                <td><input class="tiny" name="system.salvaciones.fortaleza.bonoEspecial" type="number" value="{{system.salvaciones.fortaleza.bonoEspecial}}"></td>
                <td>{{system.salvaciones.fortaleza.total}}</td>
                <td class="rollcell"><button class="btn" data-action="roll-salv" data-key="fortaleza">üé≤</button></td></tr>
            <tr><td style="text-align:left;">Reflejos</td>
                <td><input class="tiny" name="system.salvaciones.reflejos.bonoEspecial" type="number" value="{{system.salvaciones.reflejos.bonoEspecial}}"></td>
                <td>{{system.salvaciones.reflejos.total}}</td>
                <td class="rollcell"><button class="btn" data-action="roll-salv" data-key="reflejos">üé≤</button></td></tr>
            <tr><td style="text-align:left;">Voluntad</td>
                <td><input class="tiny" name="system.salvaciones.voluntad.bonoEspecial" type="number" value="{{system.salvaciones.voluntad.bonoEspecial}}"></td>
                <td>{{system.salvaciones.voluntad.total}}</td>
                <td class="rollcell"><button class="btn" data-action="roll-salv" data-key="voluntad">üé≤</button></td></tr>
          </tbody>
        </table>
      </div>

      <div class="panel">
        <div class="title">HABILIDADES NATURALES</div>
        <table>
          <thead><tr><th>Habilidad</th><th>Origen</th><th>Rangos</th><th>Extra</th><th>Total</th><th>üé≤</th></tr></thead>
          <tbody>
            {{#each system.habilidadesNaturales as |h i|}}
            <tr>
              <td style="text-align:left;">{{h.nombre}}</td>
              <td><input class="tiny" name="system.habilidadesNaturales.{{i}}.origen" type="number" value="{{h.origen}}"></td>
              <td><input class="tiny" name="system.habilidadesNaturales.{{i}}.rangos" type="number" value="{{h.rangos}}"></td>
              <td><input class="tiny" name="system.habilidadesNaturales.{{i}}.extra"  type="number" value="{{h.extra}}"></td>
              <td>{{h.total}}</td>
              <td class="rollcell"><button class="btn" type="button" data-action="roll-hab" data-index="{{i}}">üé≤</button></td>
            </tr>
            {{/each}}
          </tbody>
        </table>
      </div>

      <div class="panel">
        <div class="title">Disciplinas</div>
        <table>
          <thead><tr><th>Disciplina</th><th>Dado</th><th>Origen</th><th>Rangos</th><th>Extra</th><th>D</th><th>I</th><th>C</th><th>üé≤</th></tr></thead>
          <tbody>
            {{#each system.disciplinas as |d k|}}
            <tr>
              <td style="text-align:left;">{{k}}</td>
              <td><input class="tiny" name="system.disciplinas.{{k}}.dado"   value="{{d.dado}}"></td>
              <td><input class="tiny" name="system.disciplinas.{{k}}.origen" type="number" value="{{d.origen}}"></td>
              <td><input class="tiny" name="system.disciplinas.{{k}}.rangos" type="number" value="{{d.rangos}}"></td>
              <td><input class="tiny" name="system.disciplinas.{{k}}.especial" type="number" value="{{d.especial}}"></td>
              <td>{{d.totalD}}</td><td>{{d.totalI}}</td><td>{{d.totalC}}</td>
              <td class="rollcell">
                <button class="btn" type="button" data-action="roll-disc" data-key="{{k}}" data-canal="D">D</button>
                <button class="btn" type="button" data-action="roll-disc" data-key="{{k}}" data-canal="I">I</button>
                <button class="btn" type="button" data-action="roll-disc" data-key="{{k}}" data-canal="C">C</button>
              </td>
            </tr>
            {{/each}}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</form>
